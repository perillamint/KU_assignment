%!TEX TS-program = xelatex

\documentclass {article}

\input {../../commonpackages.tex}

%\setmainfont {NanumMyeongjo}
\setmainfont {UnBatang}
\setmonofont[Scale=0.8]{DejaVu Sans Mono}

\input {../../lststyles.tex}
\begin {document}

\title {전화번호부 프로그램의 설계}
\input {../../reportauthor.tex}
\maketitle

\clearpage

\section{전화번호 프로그램의 설계}
\subsection{프로그램의 형태}
프로그램은 대화형 커맨드 라인 어플리케이션으로 작성한다.
\subsection{프로그램의 인터페이스}
\begin{itemize}
\item CUI 인터페이스를 사용한다. 이 중 터미널의 첫 번째 줄은 현재 무슨 기능이 실행 중인지를 표시하는데 사용한다.(이하 상태표시줄)
\item 터미널의 제일 아랫 줄은 해당 기능에서 요구하는 데이터 입력을 위해 사용한다.(이하 입력 프롬프트)
\item 위 한 줄을 제외한 터미널의 부분은, 데이터 표시와 입력 영역으로 사용한다. (이하 입출력 영역)
\item 입출력 영역에서는, 데이터의 출력이 끝난 뒤, 입력 모드로 전환되고, 입력 모드가 끝나면, 데이터의 출력을 하도록 한다.
\item 입력 모드에 진입할 때는, 새 줄에서, > 기호를 이용해 입력 프롬프트임을 표시해야 한다.
\item 입츨력 영역의 입력 모드를 벗어나는 키는 리턴 키로 한다.
\item 입력 모드의 데이터는, 입력 모드를 벗어날 때에 처리한다.
\end{itemize}

해당 인터페이스를 구현하기 위해서, ANSI 제어 문자 또는 W32 Console API 혹은 ncurses, PDCurses 와 같은 라이브러리를 사용한다.

\section{데이터의 저장}
프로그램은 한 전화번호와 이름을 저장할 때, 다음과 같은 것들을 저장해야 한다.

\begin{enumerate}
\item 해당 항목의 고유 키
\item 이름
\item 전화번호
\end{enumerate}

데이터의 제약
\begin{itemize}
\item 이름은, 유니코드 문자이며, 전화번호는 숫자만 입력된다.
\item 이름과 전화번호는 빌 수 없다. (NOT NULL)
\item 고유 키는, 해당 데이터베이스 내에, 같은 값을 가지는 항목이 해당 키를 가지고 있는 엔트리 외에는 없는 값을 말한다.
\item 데이터의 저장은 메모리 위의 자료구조에만 저장하도록 한다.(이하 데이터베이스)
\end{itemize}

구현 언어가 C 일 경우 데이터의 구조는 다음과 같이, 링크드 리스트 형태로 한다.
\begin{lstlisting}
  struct phone_entry {
    struct phone_entry *prev;
    struct phone_entry *next;
    int64_t key;
    char *name;
    char *phone_no;
  }
\end{lstlisting}
혹은, Rust 나 C++ 과 같이, 리스트 자료구조가 제공된다면, 해당 자료구조를 이용하되, 자료구조 안에 들어가는 전화번호부 엔트리를 다음과 같은 식으로 한 뒤, 해당 자료구조에 넣는 식으로 구현해도 무방하다.
\begin{lstlisting}
  struct PhoneEntry {
    key: i64,
    name: String,
    phone_no: String,
  }
\end{lstlisting}
\section{프로그램의 기능}
\subsection{검색 모드}
\begin{enumerate}
\item 프로그램이 초기 시동 시에, 프로그램은 검색 모드로 진입한다. 해당 모드에서, 프로그램은 상태표시줄에 ``검색 모드'' 문자열을 출력하고, 입출력 영역에 ``무슨 기능을 원하십니까? (1. 이름으로 검색 2. 전화번호로 검색 3. 데이터 추가)'' 를 출력한 뒤, 입력 모드로 전환한다.
\item 입력 모드에서 숫자가 입력되면 해당 기능을 수행한다.
\item 이 중, 이름의 경우에는, 부분 일치 또한 검색되도록 해야 한다. 이를 위해, 정규표현식을 사용자 입력으로부터 만들어, 검색한 후, 이를 원본 문자열과의 distance 를 기준으로 정렬한 뒤, 고유 키와 이름과 전화번호를 표시한다.
\item 전화번호의 경우, 완전 일치하는 경우에만, 고유 키와 이름과 전화번호를 출력한다.
\item 데이터 추가의 경우, 아래의 데이터 추가 모드로 전환한다.
\item 이후, ``1. 데이터 편집 2. 데이터 삭제 3. 데이터 추가 4. 계속 검색'' 문자열을 출력한 후, 명령 모드로 진입해, 입력을 받은 후, 각각에 해당하는 모드로 전환한다.
\end{enumerate}
\subsection{데이터 추가 기능}
\begin{enumerate}
\item 해당 모드에서, 프로그램은 상태표시줄에 ``추가 모드'' 문자열을 출력하고, 입출력 영역에 ``이름을 입력하십시오.'' 를 출력한 뒤, 입력 모드로 전환한다.
\item 입력 모드에서, 입력을 받은 뒤, ``전화번호를 입력하십시오.'' 를 출력한 뒤, 입력 모드로 전환한다.
\item 전화번호를 입력받은 뒤, 해당 전화번호 항목의 고유 키를 생성한다.
\item 이후, 이름과, 전화번호와, 생성된 키를 데이터베이스에 추가한다.
\item 기능을 마친 후, 검색 모드로 전환한다.
\end{enumerate}
\subsection{데이터 편집 기능}
\begin{enumerate}
\item 해당 모드에서, 프로그램은 상태표시줄에 ``편집 모드'' 문자열을 출력하고, 입출력 영역에 ``편집 대상의 키를 입력하십시오.'' 를 출력한 뒤, 입력 모드로 전환한다.
\item 입력 모드에서 입력을 받은 뒤, ``무엇을 편집하시겠습니까? (1. 이름 2. 전화번호) 를 출력한 뒤, 입력 모드로 전환한다.
\item 입력 모드에서, 무엇을 편집할지를 받은 후, ``데이터를 입력하십시오.'' 를 출력한 뒤, 입력 모드로 전환한다.
\item 입력을 받은 데이터와 편집 대상을 가지고, 해당 키를 가진 데이터를 편집한다.
\item 기능을 마친 후, 검색 모드로 전환한다.
\end{enumerate}
\subsection{데이터 삭제 기능}
\begin{enumerate}
\item 해당 모드에서, 프로그램은 상태표시줄에 ``삭제 모드'' 문자열을 출력하고, 입출력 영역에 ``삭제 대상의 키를 입력하십시오.'' 를 출력한 뒤, 입력 모드로 전환한다.
\item 입력 모드에서, 입력을 받은 뒤, ``정말로 삭제하시겠습니까? (Y/N)'' 을 출력한 뒤, 입력 모드로 전환한다.
\item 입력을 받은 입력이 y, Y 일 경우는, ``삭제 하였습니다.'' 메시지 출력 후 삭제, 그 외의 경우는 ``동작이 취소되었습니다.'' 메시지를 출력한다.
\item 기능을 마친 후, 검색 모드로 전환한다.
\end{enumerate}
\section{예외 처리}
이 설계에서 처리할 수 없는 입력이 들어왔을 경우, ``해당 요청을 처리할 수 없습니다.'' 문자열을 출력 후, 검색 모드로 전환한다.

\end {document}
